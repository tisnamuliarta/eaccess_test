(window.webpackJsonp=window.webpackJsonp||[]).push([[34,22],{1035:function(t,e,o){"use strict";o.r(e);var n=o(108),r=o(785),l=o(954),d=o(134),c=o(277),m=o(184),h=o(25),f=o(635),v=o(629),x=(o(35),o(239),o(774).a),_=o(62),component=Object(_.a)(x,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"mx-auto"},[e(l.a,{staticClass:"elevation-1",attrs:{"mobile-breakpoint":0,headers:t.headers,items:t.allData,"items-per-page":20,options:t.options,"server-items-length":t.totalData,loading:t.loading,"show-select":"","fixed-header":"",height:"70vh",dense:"","footer-props":{"items-per-page-options":[20,50,100,-1]}},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"top",fn:function(){return[e("LazyMainToolbar",{attrs:{"document-status":t.documentStatus,"search-status":t.searchStatus,"item-search":t.itemSearch,"item-date-filter":t.itemDateFilter,"search-item":t.searchItem,search:t.search,title:t.tableTitle,"show-batch-action":!0,"show-table-filter":!1,"show-filter":!0,"batch-actions":t.batchItems,"new-data-text":"New Document"},on:{emitData:t.emitData,newData:t.newData,batchActions:t.batchActions}})]},proxy:!0},{key:"item.files",fn:function(o){var n=o.item;return[e(d.a,{staticClass:"mr-2",attrs:{small:"",color:"orange"},on:{click:function(e){return t.openAttchment(n)}}},[t._v("\n          mdi-attachment\n        ")])]}},{key:"item.total",fn:function(o){var n=o.item;return[e("span",{domProps:{textContent:t._s(t.formatPrice(n.total))}})]}},{key:"item.id",fn:function(o){var r=o.item;return["approved - finish"===r.status||"approved"===r.status?e(n.a,{staticClass:"font-weight-bold text-right pr-0",attrs:{color:"primary",text:"","x-small":""},on:{click:function(e){return t.actions("Download",r)}}},[t._v("\n          Download\n        ")]):"draft"!==r.status?e(n.a,{staticClass:"font-weight-bold text-right pr-0",attrs:{color:"primary",text:"","x-small":""},on:{click:function(e){return t.actions("Approval Stages",r)}}},[t._v("\n          Approval Stages\n        ")]):"draft"!==r.status||"Y"!==r.meterai_coordinate&&"Y"!==r.digisign_coordinate?e(n.a,{staticClass:"font-weight-bold text-right pr-0",attrs:{color:"primary",text:"","x-small":""},on:{click:function(e){return t.actions("Edit",r)}}},[t._v("\n          Edit\n        ")]):e(n.a,{staticClass:"font-weight-bold text-right pr-0",attrs:{color:"primary",text:"","x-small":""},on:{click:function(e){return t.actions("Submit Approval",r)}}},[t._v("\n          Submit Approval\n        ")]),t._v(" "),e(f.a,{attrs:{transition:"slide-y-transition",bottom:""},scopedSlots:t._u([{key:"activator",fn:function(o){var r=o.on,l=o.attrs;return[e(n.a,t._g(t._b({staticClass:"mr-2",attrs:{color:"black",dark:"",icon:""}},"v-btn",l,!1),r),[e(d.a,[t._v("mdi-menu-down")])],1)]}}],null,!0)},[t._v(" "),e(c.a,t._l(t.getItemActions(r),(function(o,i){return e(m.a,{key:i,on:{click:function(e){return t.actions(o,r)}}},[e(h.a,[e(h.c,[t._v(t._s(o))])],1)],1)})),1)],1)]}},{key:"item.editor",fn:function(o){var n=o.item;return[n.attachment?e(d.a,{staticClass:"mr-2",attrs:{small:"",color:"green"},on:{click:function(e){return t.$refs.formEditor.newData(n.attachment.file_path,n)}}},[t._v("\n          mdi-image-edit\n        ")]):t._e()]}},{key:"item.submit",fn:function(o){var n=o.item;return["draft"===n.status&&n.attachment&&n.vis_digisign_llx&&n.vis_llx?e(d.a,{staticClass:"mr-2",attrs:{small:"",color:"orange"},on:{click:function(e){return t.submitDocument(n)}}},[t._v("\n          mdi-cloud-upload\n        ")]):t._e()]}},{key:"item.download",fn:function(o){var n=o.item;return["approved"===n.status?e(d.a,{staticClass:"mr-2",attrs:{small:"",color:"orange"},on:{click:function(e){return t.downloadDocument(n)}}},[t._v("\n          mdi-download\n        ")]):t._e()]}},{key:"item.status",fn:function(o){var l=o.item;return[e("div",[e(r.a,{staticClass:"text-capitalize",attrs:{label:"",small:"",link:"",dark:"",color:t.getColorStatus(l.status)},on:{click:function(e){return t.openBatchApproval(l)}}},[t._v("\n            "+t._s(l.status)+"\n          ")]),t._v(" "),"approved - failed"===l.status||"failed - approve"===l.status?e(v.a,{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(o){var r=o.on,c=o.attrs;return[e(n.a,t._g(t._b({attrs:{color:"green",elevation:"0",dark:"",small:"",icon:"",outlined:""},on:{click:function(e){return t.reProcess(l.id)}}},"v-btn",c,!1),r),[e(d.a,[t._v("mdi-database-refresh")])],1)]}}],null,!0)},[t._v(" "),e("span",[t._v("Re-process document")])]):t._e()],1)]}},{key:"item.stages",fn:function(o){var n=o.item;return["pending"===n.status?e(d.a,{staticClass:"mr-2",attrs:{small:"",color:"orange"},on:{click:function(e){return t.$refs.approvalStages.openApprovalStages(n)}}},[t._v("\n          mdi-format-line-weight\n        ")]):t._e()]}},{key:"item.meterai_coordinate",fn:function(o){var n=o.item;return["Y"===n.meterai_coordinate?e(d.a,{attrs:{color:"green"},on:{click:function(e){return t.openEditor(n)}}},[t._v("mdi-check-all")]):e(d.a,{attrs:{color:"red"},on:{click:function(e){return t.openEditor(n)}}},[t._v("mdi-cancel")])]}},{key:"item.digisign_coordinate",fn:function(o){var n=o.item;return["Y"===n.digisign_coordinate?e(d.a,{attrs:{color:"green"},on:{click:function(e){return t.openEditor(n)}}},[t._v("mdi-check-all")]):e(d.a,{attrs:{color:"red"},on:{click:function(e){return t.openEditor(n)}}},[t._v("mdi-cancel")])]}}],null,!0),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1),t._v(" "),e("LazyDocumentFormDocument",{ref:"forms",attrs:{"form-data":t.form,"document-type":t.documentType,"document-types":t.documentTypes,"form-title":t.formTitle,"button-title":t.buttonTitle,url:t.url,approval:t.approval,"item-customer":t.itemCustomer,"item-sign-payment":t.itemSignPayment},on:{getDataFromApi:t.getDataFromApi}}),t._v(" "),e("LazyDocumentDialogApproval",{ref:"formApproval",attrs:{"form-data":t.form,"document-type":t.documentType,"form-title":t.formTitle,"button-title":t.buttonTitle,url:t.url,"item-customer":t.itemCustomer},on:{getDataFromApi:t.getDataFromApi}}),t._v(" "),e("LazyDocumentUploadDocument",{ref:"formUpload",attrs:{"form-data":t.form,"document-type":t.documentType,"form-title":"Files","button-title":t.buttonTitle,url:t.url},on:{getDataFromApi:t.getDataFromApi,eventCountAttachment:t.eventCountAttachment}}),t._v(" "),e("LazyDocumentEditor",{ref:"formEditor",attrs:{"form-data":t.form,"document-type":t.documentType,"form-title":t.formTitle,"button-title":t.buttonTitle,url:t.url},on:{coordinate:t.coordinate}}),t._v(" "),e("LazyDocumentBatchApproval",{ref:"batchApproval",on:{getDataFromApi:t.getDataFromApi}}),t._v(" "),t.dialogLoading?e("LazySpinnerLoading",{ref:"spinnerLoadingImport"}):t._e(),t._v(" "),e("LazyDocumentApprovalStages",{ref:"approvalStages"}),t._v(" "),e("DialogForm",{ref:"dialogPdf",attrs:{"max-width":"1000px","dialog-title":"Files","button-title":"Close"},scopedSlots:t._u([{key:"content",fn:function(){return[e("iframe",{staticStyle:{width:"100%",height:"100vh",border:"none"},attrs:{src:t.pdfSource}},[t._v("\n        Oops! an error has occurred.\n      ")])]},proxy:!0}])})],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{DialogForm:o(666).default})},666:function(t,e,o){"use strict";o.r(e);var n=o(108),r=o(125),l=o(52),d=o(643),c=o(302),m=o(634),h=o(134),f=o(301),v={name:"DialogForm",props:{maxWidth:{type:String,default:"800px"},dialogTitle:{type:String,default:""}},data:function(){return{dialog:!1}},methods:{addLine:function(){this.$emit("addLine")},openDialog:function(){this.dialog=!0},closeDialog:function(){this.dialog=!1,this.$emit("eventCloseDialog")},saveData:function(){this.$emit("saveData")}}},x=o(62),component=Object(x.a)(v,(function(){var t=this,e=t._self._c;return e(c.a,{attrs:{"no-click-animation":"",persistent:"",scrollable:"","max-width":t.maxWidth,transition:"dialog-top-transition","retain-focus":!1},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[e(r.a,[e(l.d,[e("span",{staticClass:"subtitle-2"},[t._v(t._s(t.dialogTitle))]),t._v(" "),e(f.a),t._v(" "),e(n.a,{attrs:{icon:"",color:"red",dark:""},on:{click:function(e){return t.closeDialog()}}},[e(h.a,[t._v("mdi-close-circle")])],1)],1),t._v(" "),e(m.a),t._v(" "),e(l.c,{staticClass:"pl-0 pr-0"},[e(d.a,{attrs:{fluid:""}},[t._t("content")],2)],1),t._v(" "),e(m.a),t._v(" "),e(l.a,[e(f.a),t._v(" "),t._t("addLine"),t._v(" "),t._t("saveData")],2)],1)],1)}),[],!1,null,null,null);e.default=component.exports},774:function(t,e,o){"use strict";(function(t){o(787),o(26),o(35),o(72),o(423),o(6),o(84),o(36),o(12),o(39),o(45),o(242),o(195),o(53),o(239),o(13);e.a={name:"Account",props:{tableTitle:{type:String,default:""},documentTypes:{type:String,default:""}},data:function(){return{totalData:0,editedIndex:-1,loading:!1,dialogLoading:!1,selected:[],allData:[],documentType:[],itemCustomer:[],itemDateFilter:[],itemSignPayment:[],documentStatus:[],itemSearch:[],coordinateData:[],arrayEsign:[],arrayMaterai:[],approval:[],searchStatus:"All",searchItem:"",search:"",dateFrom:"",dateTo:"",pdfSource:"",form:{},defaultItem:{},defaultAction:"Edit",defaultActionText:"Edit",options:{},headers:[],url:"/api/document",page:1,numPages:0,pdfdata:void 0,errors:[],scale:"page-width"}},head:function(){return{title:"Documents"}},computed:{formTitle:function(){return-1===this.editedIndex?"New Data":"Edit Data"},buttonTitle:function(){return-1===this.editedIndex?"Save":"Update"},formattedZoom:function(){return Number.parseInt(100*this.scale)},batchItems:function(){switch(this.searchStatus){case"Draft":return["Submit Approval","Delete"];case"Pending":return["Cancel"];case"Approved":return["Download"];default:return[""]}}},watch:{options:{handler:function(){this.getDataFromApi()},deep:!0}},mounted:function(){var t=this;this.getHeaders(),this.getCustomer(),this.getUserApproval(),this.$echo.channel("Document."+this.$auth.user.id).on("document.updated",(function(e){t.getDataFromApi()}))},methods:{formatPrice:function(t){return(t/1).toFixed(0).replace(".",",").toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},getHeaders:function(){var header=[{text:"File Name",value:"external_document_number",cellClass:"disable-wrap"},{text:"Internal Number",value:"document_number",cellClass:"disable-wrap"},{text:"Document Type",value:"type",class:"disable-wrap",sortable:!1,filterable:!1,width:"120px"},{text:"Sub Type",value:"document_sub_type_name",cellClass:"disable-wrap",sortable:!1,filterable:!1},{text:"Customer",value:"customer_name"},{text:"Document Date",value:"document_date",cellClass:"disable-wrap",sortable:!1,filterable:!1},{text:"Total",value:"total",cellClass:"disable-wrap",align:"right"},{text:"Status",value:"status",cellClass:"disable-wrap",sortable:!1,filterable:!1},{text:"Remark",value:"remark",cellClass:"disable-wrap",sortable:!1,filterable:!1},{text:"Coordinate Meterai",value:"meterai_coordinate",align:"center",width:"80px",sortable:!1,filterable:!1},{text:"Coordinate Sign",value:"digisign_coordinate",align:"center",width:"80px",sortable:!1,filterable:!1},{text:"Actions",value:"id",align:"right",width:"50px",sortable:!1,filterable:!1,cellClass:"disable-wrap"}];if(this.$gates.hasRole("Admin E-Meterai Other"))this.headers=[{text:"Internal Number",value:"document_number",cellClass:"disable-wrap"},{text:"Document Type",value:"type",class:"disable-wrap",sortable:!1,filterable:!1},{text:"Document Date",value:"document_date",cellClass:"disable-wrap",sortable:!1,filterable:!1},{text:"Sign Payment",value:"sign_payments",cellClass:"disable-wrap"},{text:"Status",value:"status",cellClass:"disable-wrap",sortable:!1,filterable:!1},{text:"Remark",value:"remark",cellClass:"disable-wrap",sortable:!1,filterable:!1},{text:"Coordinate Meterai",value:"meterai_coordinate",align:"center",width:"80px",sortable:!1,filterable:!1},{text:"Coordinate Sign",value:"digisign_coordinate",align:"center",width:"80px",sortable:!1,filterable:!1},{text:"Actions",value:"id",align:"right",width:"50px",sortable:!1,filterable:!1,cellClass:"disable-wrap"}];else if(this.$gates.hasRole("Superuser")){this.headers=[].concat(header,[{text:"Sign Payment",value:"sign_payments",cellClass:"disable-wrap"},{text:"Created By",value:"user_create.name",sortable:!1,filterable:!1}])}else this.headers=header},getColorStatus:function(t){switch(t){case"draft":return"grey";case"pending":return"orange";case"canceled":case"approved - failed":return"red";case"finish":case"approved":case"approved - finish":return"green";case"approved - on process":return"blue"}},getUserApproval:function(){var t=this;this.$axios.get("/api/master/approval-mapping-user").then((function(e){t.approval=e.data.data.rows})).catch((function(e){t.$swal({type:"error",title:"Error",text:e.response.data.message})}))},reProcess:function(t){var e=this;this.btnLoading=!0,this.$axios.post("/api/approval/batch-reprocess/"+t).then((function(t){e.btnLoading=!1,e.getDataFromApi()})).catch((function(t){e.btnLoading=!1,e.$swal({type:"error",title:"Error",text:t.response.data.message})}))},openBatchApproval:function(t){"approved"!==t.status&&"approved - finish"!==t.status&&"approved - on process"!==t.status&&"approved - failed"!==t.status&&"finish"!==t.status&&"pending"!==t.status||this.$refs.batchApproval.openApprovalDialog(t)},checkColorStatus:function(t){switch(t.status){case"pending":return"bg-orange";case"canceled":return"bg-red";case"approved":return"bg-green";default:return"bg-white"}},newData:function(){this.editedIndex=-1,this.$refs.forms.newData(this.documentType,this.defaultItem)},openEditor:function(t){"draft"===t.status&&this.$refs.formEditor.newData(t.attachment.file_path,t)},coordinateInvoice:function(){var t=[],e=[];return this.coordinateData.forEach((function(element,o){if("materai"===element.id)t.push({meterai_coordinate:"Y",meterai_id:element.id,meterai_color:element.color,meterai_stamp_type:element.stampType,meterai_page_index:element.pageIndex,meterai_top:element.boundingBox.top,meterai_left:element.boundingBox.left,meterai_width:element.boundingBox.width,meterai_height:element.boundingBox.height,visLLX:element.boundingBox.left,visLLY:800-parseFloat(element.boundingBox.top),visURX:parseFloat(element.boundingBox.left)+parseFloat(element.boundingBox.width),visURY:800-parseFloat(element.boundingBox.top)-parseFloat(element.boundingBox.height),pageIndex:element.pageIndex});else if("sign"===element.id)e.push({digisign_coordinate:"Y",digisign_id:element.id,digisign_color:element.color,digisign_stamp_type:element.stampType,digisign_page_index:element.pageIndex,digisign_top:element.boundingBox.top,digisign_left:element.boundingBox.left,digisign_width:element.boundingBox.width,digisign_height:element.boundingBox.height,visLLX:element.boundingBox.left,visLLY:800-parseFloat(element.boundingBox.top)-parseFloat(element.boundingBox.height),visURX:parseFloat(element.boundingBox.left)+parseFloat(element.boundingBox.width),visURY:800-parseFloat(element.boundingBox.top),pageIndex:element.pageIndex});else{var n=parseFloat(element.boundingBox.height)/2,r=parseFloat(element.boundingBox.top)-40;t.push({meterai_coordinate:"Y",meterai_id:element.id,meterai_color:element.color,meterai_stamp_type:element.stampType,meterai_page_index:element.pageIndex,meterai_top:element.boundingBox.top,meterai_left:element.boundingBox.left,meterai_width:element.boundingBox.width,meterai_height:element.boundingBox.height,visLLX:element.boundingBox.left,visLLY:800-r,visURX:parseFloat(element.boundingBox.left)+parseFloat(element.boundingBox.height),visURY:800-r-parseFloat(element.boundingBox.height),pageIndex:element.pageIndex}),e.push({digisign_coordinate:"Y",digisign_id:element.id,digisign_color:element.color,digisign_stamp_type:element.stampType,digisign_page_index:element.pageIndex,digisign_top:element.boundingBox.top,digisign_left:element.boundingBox.left,digisign_width:element.boundingBox.width,digisign_height:element.boundingBox.height,visLLX:parseFloat(element.boundingBox.left)+parseFloat(element.boundingBox.height),visLLY:800-r-parseFloat(element.boundingBox.height),visURX:parseFloat(element.boundingBox.left)+parseFloat(element.boundingBox.height)+3*n,visURY:800-r,pageIndex:element.pageIndex})}})),[t,e]},coordinateOther:function(){var t=[],e=[];return this.coordinateData.forEach((function(element,o){if("METERAI"===element.title)t.push({meterai_coordinate:"Y",meterai_id:element.id,meterai_color:element.color,meterai_stamp_type:element.stampType,meterai_page_index:element.pageIndex,meterai_top:element.boundingBox.top,meterai_left:element.boundingBox.left,meterai_width:element.boundingBox.width,meterai_height:element.boundingBox.height,visLLX:element.boundingBox.left,visLLY:800-parseFloat(element.boundingBox.top),visURX:parseFloat(element.boundingBox.left)+parseFloat(element.boundingBox.width),visURY:800-parseFloat(element.boundingBox.top)-parseFloat(element.boundingBox.height),pageIndex:element.pageIndex});else if("SIGN HERE"===element.title)e.push({digisign_coordinate:"Y",digisign_id:element.id,digisign_color:element.color,digisign_stamp_type:element.stampType,digisign_page_index:element.pageIndex,digisign_top:element.boundingBox.top,digisign_left:element.boundingBox.left,digisign_width:element.boundingBox.width,digisign_height:element.boundingBox.height,visLLX:element.boundingBox.left,visLLY:800-parseFloat(element.boundingBox.top)-parseFloat(element.boundingBox.height),visURX:parseFloat(element.boundingBox.left)+parseFloat(element.boundingBox.width),visURY:800-parseFloat(element.boundingBox.top),pageIndex:element.pageIndex});else{var n=parseFloat(element.boundingBox.height)/2,r=parseFloat(element.boundingBox.top)-40;t.push({meterai_coordinate:"Y",meterai_id:element.id,meterai_color:element.color,meterai_stamp_type:element.stampType,meterai_page_index:element.pageIndex,meterai_top:element.boundingBox.top,meterai_left:element.boundingBox.left,meterai_width:element.boundingBox.width,meterai_height:element.boundingBox.height,visLLX:element.boundingBox.left,visLLY:800-r,visURX:parseFloat(element.boundingBox.left)+parseFloat(element.boundingBox.height),visURY:800-r-parseFloat(element.boundingBox.height),pageIndex:element.pageIndex}),e.push({digisign_coordinate:"Y",digisign_id:element.id,digisign_color:element.color,digisign_stamp_type:element.stampType,digisign_page_index:element.pageIndex,digisign_top:element.boundingBox.top,digisign_left:element.boundingBox.left,digisign_width:element.boundingBox.width,digisign_height:element.boundingBox.height,visLLX:parseFloat(element.boundingBox.left)+parseFloat(element.boundingBox.height),visLLY:800-r-parseFloat(element.boundingBox.height),visURX:parseFloat(element.boundingBox.left)+parseFloat(element.boundingBox.height)+3*n,visURY:800-r,pageIndex:element.pageIndex})}})),[t,e]},coordinate:function(data){var t=this;this.coordinateData=[],this.coordinateData=data.data,this.arrayMaterai=[],this.arrayEsign=[];var e=this.arrayMaterai,o=this.arrayEsign;this.dialogLoading=!0,"invoice"===data.item.document_type?(e.push(this.coordinateInvoice()[0]),o.push(this.coordinateInvoice()[1])):(e.push(this.coordinateOther()[0]),o.push(this.coordinateOther()[1])),this.$axios.post(this.url+"/update-coordinate",{arrayMaterai:e,arrayEsign:o,id:data.item.id,document_type:data.item.document_type}).then((function(e){t.dialogLoading=!1,t.getDataFromApi()})).catch((function(e){t.$swal({type:"error",title:"Error",text:e.data.message})})).finally((function(){return t.dialogLoading=!1}))},openAttchment:function(t){this.$refs.formUpload.newData(t)},eventCountAttachment:function(data){this.getDataFromApi()},actions:function(t,e){switch(t){case"Edit":this.editItem(e);break;case"View PDF":this.viewPdf(e);break;case"View Files":this.openAttchment(e);break;case"Submit Approval":this.submitDocument(e);break;case"Cancel Approval":this.cancelDocument(e);break;case"Download":this.downloadDocument(e);break;case"Delete":this.batchDeleteDocument([e.id]);break;case"Approval Stages":this.$refs.approvalStages.openApprovalStages(e);break;case"Reject":this.$refs.formApproval.editItem(e,"Reject");break;case"Approve":this.$refs.formApproval.editItem(e,"Approve");break;case"Open Editor":this.$refs.formEditor.newData(e.attachment.file_path,e)}},handle_pdf_link:function(t){document.getElementById(String(t.pageNumber)).scrollIntoView()},viewPdf:function(t){this.$refs.dialogPdf.openDialog(),this.pdfSource="",this.pdfSource=t.attachment.file_path},getItemActions:function(t){switch(t.status){case"draft":return["View Files","Open Editor","Submit Approval","Delete"];case"pending":return["Cancel Approval"];default:return["View Files","Approval Stages"]}},cancelDocument:function(t){var e=this;this.$swal({title:"Are you sure?",text:"Status approval dokumen ini akan diubah menjadi Cancel!",type:"warning",showCancelButton:!0,confirmButtonText:"Yes, Cancel!",cancelButtonText:"No",reverseButtons:!0}).then((function(o){if(!0===o.value){var n=e.url+"/cancel-document";e.$axios.post(n,t).then((function(t){e.$swal({title:"Success!",text:t.data.message,type:"success"}),e.getDataFromApi()})).catch((function(t){e.$swal({type:"error",title:"Error",text:t.response.data.message})}))}}))},batchCancelDocument:function(t){var e=this;this.$swal({title:"Are you sure?",text:"Status approval dokumen ini akan diubah menjadi Cancel!",type:"warning",showCancelButton:!0,confirmButtonText:"Yes, Cancel!",cancelButtonText:"No",reverseButtons:!0}).then((function(o){if(!0===o.value){var n=e.url+"/batch-cancel-document";e.$axios.post(n,t).then((function(t){e.$swal({title:"Success!",text:t.data.message,type:"success"}),e.getDataFromApi()})).catch((function(t){e.$swal({type:"error",title:"Error",text:t.response.data.message})}))}}))},batchDeleteDocument:function(t){var e=this;this.$swal({title:"Are you sure?",text:"Document will deleted permanently!",type:"warning",showCancelButton:!0,confirmButtonText:"Yes, Delete!",cancelButtonText:"No",reverseButtons:!0}).then((function(o){if(!0===o.value){var n=e.url+"/batch-delete-document";e.$axios.delete(n,{params:{id:t}}).then((function(t){e.$swal({title:"Success!",text:t.data.message,type:"success"}),e.getDataFromApi()})).catch((function(t){e.$swal({type:"error",title:"Error",text:t.response.data.message})}))}}))},editItem:function(t){this.editedIndex=this.allData.indexOf(t),this.$refs.forms.editItem(t,this.documentType)},openFormApproval:function(t,e){this.editedIndex=this.allData.indexOf(t),this.$refs.formApproval.editItem(t,e)},submitDocument:function(t){var e=this;this.dialogLoading=!0,this.$axios.post(this.url+"/approval",{id:t.id}).then((function(t){e.dialogLoading=!1,e.getDataFromApi()})).catch((function(t){e.$swal({type:"error",title:"Error",text:t.response.data.message})})).finally((function(){return e.dialogLoading=!1}))},batchSubmitDocument:function(t){var e=this;this.dialogLoading=!0,this.$axios.post(this.url+"/batch-approval",t).then((function(t){e.dialogLoading=!1,e.getDataFromApi()})).catch((function(t){e.$swal({type:"error",title:"Error",text:t.response.data.message})})).finally((function(){return e.dialogLoading=!1}))},downloadDocument:function(e){var o=this;this.arrayMaterai=[],this.arrayEsign=[],this.dialogLoading=!0,this.$axios.get(this.url+"/download",{params:{id:e.id,type:"single"},responseType:"arraybuffer"}).then((function(t){o.dialogLoading=!1;var n=new Blob([t.data],{type:"application/pdf"}),r=window.URL.createObjectURL(n),link=document.createElement("a");link.href=window.URL.createObjectURL(n),o.$gates.hasRole("Admin E-Meterai Other")?link.download=e.attachment.file_name:link.download=e.external_document_number,document.body.appendChild(link),link.click(),setTimeout((function(){document.body.removeChild(link),window.URL.revokeObjectURL(r)}),100)})).finally((function(){return o.dialogLoading=!1})).catch((function(e){var n=JSON.parse(t.from(e.response.data).toString("utf8"));o.$swal({type:"error",title:"Error",text:n.message})}))},emitData:function(data){this.documentStatus=data.documentStatus,this.itemSearch=data.itemSearch,this.searchStatus=data.searchStatus,this.searchItem=data.searchItem,this.search=data.search,this.filters=data.filters,this.dateFrom=data.dateFrom,this.dateTo=data.dateTo,this.getDataFromApi()},batchActions:function(e){var o=this;if(this.selected.length<1)this.$swal({type:"error",title:"Error",text:"Please select at least 1 row!"});else try{var n=this,r=[];switch(e){case"Submit Approval":n.batchSubmitDocument(this.selected);break;case"Delete":this.selected.forEach((function(t){r.push(t.id)})),n.batchDeleteDocument(r);break;case"Cancel":n.batchCancelDocument(this.selected);break;case"Download":this.selected.forEach((function(t){r.push(t.id)})),this.dialogLoading=!0,this.$axios.get(this.url+"/download",{params:{id:r,type:"batch"},responseType:"arraybuffer"}).then((function(t){o.dialogLoading=!1;var e=new Blob([t.data],{type:"application/zip"}),n=window.URL.createObjectURL(e),link=document.createElement("a");link.href=window.URL.createObjectURL(e),link.download="E-MATERAI",document.body.appendChild(link),link.click(),setTimeout((function(){document.body.removeChild(link),window.URL.revokeObjectURL(n)}),100)})).catch((function(e){var n=JSON.parse(t.from(e.response.data).toString("utf8"));o.$swal({type:"error",title:"Error",text:n.message})})).finally((function(){return o.dialogLoading=!1}));break;case"Reject":this.$refs.formApproval.editItem(this.selected,"Reject");break;case"Approve":this.$refs.formApproval.editItem(this.selected,"Approve")}}catch(t){this.$swal({type:"error",title:"Error",text:t})}},getCustomer:function(){var t=this;this.$axios.get("/api/document/customer").then((function(e){t.itemCustomer=e.data.data.customer}))},getDataFromApi:function(){var t=this;this.loading=!0;var e=this,o=this.url;this.$axios.get(o,{params:{options:e.options,searchItem:e.searchItem,documentStatus:e.documentStatus,searchStatus:e.searchStatus,search:e.search,dateFrom:e.dateFrom,dateTo:e.dateTo,documentType:e.documentTypes}}).then((function(e){t.loading=!1,t.allData=e.data.data.rows,t.totalData=e.data.data.total,t.itemSearch=e.data.filter,t.form=Object.assign({},e.data.data.form),t.defaultItem=Object.assign({},e.data.data.form),t.documentStatus=e.data.data.document_status,t.itemSearch=e.data.data.search_item,t.documentType=e.data.data.document_type,t.itemDateFilter=e.data.data.date_filter,t.itemSignPayment=e.data.data.sign_payment,t.selected=[]})).catch((function(e){t.loading=!1,t.$swal({type:"error",title:"Error",text:e.response.data.message})}))}}}}).call(this,o(786).Buffer)}}]);