(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{753:function(t,e,r){"use strict";r.r(e);var o=r(111),n=r(128),c=r(53),l=r(840),d=r(649),m=r(1070),h=r(303),v=r(640),f=r(137),_=r(302),y=r(71),w=r(113),D=r(635),F=(r(34),r(240),r(13),r(6),r(64),r(245),r(86),r(40),r(44),r(243),r(197),r(54),{name:"ListPaper",props:{paperType:{type:String,default:""},paperName:{type:String,default:""}},data:function(){return{totalData:0,allData:[],dataFilter:[],loading:!0,dialogFilter:!1,loading1:!0,loadingPrint:!1,dialogLoading:!1,options:{},itemSearch:[],documentStatus:[],search:"",searchItem:"",searchStatus:"All",loadNewBtn:!1,defaultForm:{}}},watch:{options:{handler:function(){this.getDataFromApi()},deep:!0},search:function(){this.getDataFromApi()},$route:function(t,e){this.getDataFromApi()}},methods:{getHeader:function(){return[{text:"Date",value:"act_date"},{text:"Activity",value:"sub_role_name"},{text:"Problem",value:"problem_desc"},{text:"Problem Date",value:"problem_date"},{text:"Solution",value:"solution_desc"},{text:"Solution Date",value:"solution_date"},{text:"Actions",value:"actions"}]},emitData:function(data){this.documentStatus=data.documentStatus,this.itemSearch=data.itemSearch,this.searchStatus=data.searchStatus,this.searchItem=data.searchItem,this.search=data.search,this.getDataFromApi()},getDataFromApi:function(){var t=this;this.loading=!0;var e=this,r=this.$auth.user.username;this.$axios.get("/api/enviro-activity",{params:{options:e.options,search:e.search,searchItem:e.searchItem,type:e.paperType,user_id:r,status:e.searchStatus,clinic:"N"}}).then((function(e){t.loading=!1,t.allData=e.data.data.rows,t.totalData=e.data.data.total,t.itemSearch=e.data.data.filter,t.defaultForm=e.data.data.form})).catch((function(e){t.loading=!1,t.$swal({type:"error",title:"Error",text:e.response.data.message})}))},cancelDocument:function(t){this.$refs.formActivity.openDialog(this.paperName,"/api/enviro-activity/"+t.id,"put",this.paperType,"Non Karyawan")},sanitizeTitle:function(t){t=(t=t.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var e="àáäâèéëêìíïîòóöôùúüûñç·/_,:;",i=0,r=e.length;i<r;i++)t=t.replace(new RegExp(e.charAt(i),"g"),"aaaaeeeeiiiioooouuuunc------".charAt(i));return t=t.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},editDocument:function(t){this.$refs.formActivity.openForm("/api/enviro-activity/"+t.id,"patch",t)},printItem:function(t){var e=this;"canceled"===t.status?this.$swal({title:"Error!",text:"Form sudah dicancel!",type:"error"}):(this.loadingPrint=!0,this.$axios.get("/api/enviro-activity/print",{params:{item:t,type:this.paperType},responseType:"arraybuffer"}).then((function(r){e.loadingPrint=!1;var o=new Blob([r.data],{type:"application/pdf"}),n=window.URL.createObjectURL(o),link=document.createElement("a");link.href=window.URL.createObjectURL(o),link.download=e.sanitizeTitle(t.paper_no)+"-"+e.sanitizeTitle(t.user_name)+".pdf",document.body.appendChild(link),link.click(),setTimeout((function(){document.body.removeChild(link),window.URL.revokeObjectURL(n)}),100)})).catch((function(t){e.loadingPrint=!1,e.$swal({type:"error",title:"Error",text:t.response.data.message})})))},newData:function(){this.$refs.formActivity.openForm("/api/enviro-activity","post",this.defaultForm)}}}),x=r(61),component=Object(x.a)(F,(function(){var t=this,e=t._self._c;return e(d.a,[e(y.a,{attrs:{flat:"",color:"white",dense:""}},[e(w.a,[t._v("Activity ")]),t._v(" "),e(v.a,{staticClass:"ml-2",attrs:{inset:"",vertical:""}}),t._v(" "),e(_.a),t._v(" "),e(o.a,{staticClass:"d-md-none d-lg-none d-sm-flex d-xs-flex",attrs:{icon:"",color:"green",dark:""},on:{click:function(e){t.dialogFilter=!0}}},[e(f.a,[t._v("mdi-filter-variant")])],1),t._v(" "),e(o.a,{attrs:{icon:"",loading:t.loadNewBtn,color:"green",dark:""},on:{click:t.newData}},[e(f.a,[t._v("mdi-plus-circle")])],1),t._v(" "),e(o.a,{attrs:{loading:t.loading,icon:""},on:{click:t.getDataFromApi}},[e(f.a,[t._v("mdi-refresh")])],1)],1),t._v(" "),e("div",{staticClass:"mt-2"},[e(m.a,{staticClass:"elevation-1",attrs:{"mobile-breakpoint":0,headers:t.getHeader(),items:t.allData,"items-per-page":10,options:t.options,"server-items-length":t.totalData,loading:t.loading,dense:"","footer-props":{"items-per-page-options":[10,20,50,100,-1]}},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.actions",fn:function(r){var n=r.item;return[e("div",{staticClass:"d-flex"},[e(D.a,{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(r){var c=r.on,l=r.attrs;return[e(o.a,t._g(t._b({attrs:{icon:"","x-small":""}},"v-btn",l,!1),c),[e(f.a,{staticClass:"mr-1",attrs:{color:"blue"},on:{click:function(e){return t.editDocument(n)}}},[t._v("\n                  mdi-square-edit-outline\n                ")])],1)]}}],null,!0)},[t._v(" "),e("span",[t._v("Edit Document")])]),t._v(" "),e(D.a,{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(r){var c=r.on,l=r.attrs;return[e(o.a,t._g(t._b({attrs:{icon:""}},"v-btn",l,!1),c),[e(f.a,{staticClass:"mr-2",attrs:{small:"",color:"orange"},on:{click:function(e){return t.$refs.attachment.openAttachment(n.id,"enviro",1)}}},[t._v("\n                  mdi-attachment\n                ")])],1)]}}],null,!0)},[t._v(" "),e("span",[t._v("Attachment")])])],1)]}},{key:"item.status",fn:function(r){var o=r.item;return[e(l.a,{staticClass:"ma-1",attrs:{color:"canceled"===o.status?"red":"active"===o.status?"green":"orange",small:"","text-color":"white"}},[t._v("\n          "+t._s(o.status)+"\n        ")])]}}],null,!0)})],1),t._v(" "),e("LazyEnviroFormActivity",{ref:"formActivity",attrs:{"default-form":t.defaultForm},on:{reload:t.getDataFromApi}}),t._v(" "),e(h.a,{attrs:{persistent:"","max-width":"400px"},model:{value:t.dialogFilter,callback:function(e){t.dialogFilter=e},expression:"dialogFilter"}},[e(n.a,[e(c.d,[t._v("Filter Form")]),t._v(" "),e(c.c,[e("LazyPaperTableFilter",{attrs:{"document-status":t.documentStatus,"item-search":t.itemSearch,"search-status":t.searchStatus,"search-item":t.searchItem,search:t.search},on:{getDataFromApi:t.emitData}})],1),t._v(" "),e(c.a,[e(_.a),t._v(" "),e(o.a,{attrs:{color:"red darken-1",text:"",small:""},on:{click:function(e){t.dialogFilter=!1}}},[t._v("\n          Close\n        ")])],1)],1)],1),t._v(" "),t.loadingPrint?e("LazySpinnerLoading",{ref:"spinnerLoadingImport"}):t._e(),t._v(" "),e("LazyAttachment",{ref:"attachment"}),t._v(" "),e("LazyResvApprovalDetails",{ref:"approvalStages"})],1)}),[],!1,null,null,null);e.default=component.exports}}]);