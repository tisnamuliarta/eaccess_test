(window.webpackJsonp=window.webpackJsonp||[]).push([[130],{655:function(e,t,o){"use strict";o(303);var n=o(304);t.a=Object(n.a)("layout")},656:function(e,t,o){"use strict";o(303);var n=o(304);t.a=Object(n.a)("flex")},672:function(e,t){function o(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}o.keys=function(){return[]},o.resolve=o,e.exports=o,o.id=672},986:function(e,t,o){"use strict";o.r(t);var n=o(108),r=o(125),d=o(52),l=o(953),c=o(656),m=o(655),f=o(635),h=o(665),v=o(196),y=(o(13),o(6),o(39),o(45),o(242),o(195),o(53),o(673),o(671)),T=o(745),w=T.a.helper.debounce((function(e,t){var o=window.report.$refs.preview.hotInstance.getPlugin("filters");o.removeConditions(e),o.addCondition(e,"contains",[t.target.value]),o.filter()}),400),x=function(e){var div=document.createElement("div"),input=document.createElement("input");return div.className="filterHeader",function(input,e){input.addEventListener("keydown",(function(t){w(e,t)}))}(input,e),div.appendChild(input),div},_=function(e,t){-1===t.row&&"INPUT"===e.target.nodeName&&(e.stopImmediatePropagation(),this.deselectCell())},k={name:"Report",components:{HotTable:y.a},detailsRoot:"detailsRoot",data:function(){return{detailsRoot:"detailsRoot",form:{dateFrom:null,dateTo:null,itemType:null,requestType:null},itemType:[],requestType:[],loading:!1,showLoading:!1,loading1:!1,dialogPrevDoc:!1,KBType:null,prevTitle:"",params:{},itmTenant:[],itmTransName:[],itmTipeBc:[],editedIndex:-1,menu1:"",menu2:"",settings:{licenseKey:"non-commercial-and-evaluation",height:"70vh",afterGetColHeader:function(col,e){if("number"!=typeof col)return col;col>=0&&e.childElementCount<2&&e.appendChild(x(col));var t=e.parentNode,o=t.parentNode;o.childNodes.length,Array.prototype.indexOf.call(o.childNodes,t)},beforeOnCellMouseDown:_,manualColumnResize:!0,manualRowResize:!0,rowHeaders:!0,stretchH:"all",wordWrap:!1,filters:!0,autoRowSize:!1,autoColumnSize:!1,persistentState:!0,rowHeights:23}}},computed:{formTitle:function(){return-1===this.editedIndex?"Reservation Summary":2===this.editedIndex?"Find Document":"Edit Document"},btnTitle:function(){return-1===this.editedIndex?"Save":2===this.editedIndex?"Find":"Edit"}},created:function(){this.reportType()},methods:{reportType:function(){var e=this;window.report=this,this.$axios.get("/api/report/params").then((function(t){e.itemType=t.data.data.item_type,e.requestType=t.data.data.request_type})).catch((function(t){e.$swal({type:"error",title:"Error",text:t.response.data.message})}))},clear:function(){this.form.tenant="",this.form.kb_type="",this.form.dateType="",this.form.firstDateType="",this.form.secondDateType="",this.form.numType="",this.form.firstNumType="",this.form.secondNumType=""},close:function(){this.dialogPrevDoc=!1},exportPrev:function(e){var t=this;this.loading1=!0;var o=this.form.itemType,n=this.form.requestType,r=this.form.dateFrom,d=this.form.dateTo;this.$axios.get("/api/report/export",{params:{itemType:o,requestType:n,dateFrom:r,dateTo:d},responseType:"arraybuffer"}).then((function(e){t.loading1=!1;var l=new Blob([e.data],{type:"application/vnd.ms-excel"}),c=window.URL.createObjectURL(l),link=document.createElement("a");link.href=window.URL.createObjectURL(l),link.download="Reservation "+o+" - "+n+" -"+r+" - "+d+".xlsx",document.body.appendChild(link),link.click(),setTimeout((function(){document.body.removeChild(link),window.URL.revokeObjectURL(c)}),100)})).catch((function(e){t.$swal({type:"error",title:"Error",text:e.response.data.message}),t.loading1=!1}))},preview:function(){var e=this;this.loading=!0,this.showLoading=!0;var t=this.form.itemType,o=this.form.requestType,n=this.form.dateFrom,r=this.form.dateTo;try{this.$axios.get("/api/report/preview",{params:{itemType:t,requestType:o,dateFrom:n,dateTo:r}}).then((function(t){e.loading=!1,e.showLoading=!1,e.updateSettingSummary(t.data.data.header),setTimeout((function(){e.$refs.preview.hotInstance.loadData(t.data.data.rows),e.showLoading=!1,e.loading=!1}),500)})).catch((function(t){e.$swal({type:"error",title:"Error",text:t.response.data.message}),e.loading=!1,e.showLoading=!1}))}catch(e){this.loading=!1,this.showLoading=!1}},updateSettingSummary:function(header){this.$refs.preview.hotInstance.updateSettings({colHeaders:header,licenseKey:"non-commercial-and-evaluation",fixedRowsBottom:1,manualColumnResize:!0,manualRowResize:!0,rowHeaders:!0,filters:!0,autoRowSize:!1,autoColumnSize:!1,persistentState:!0,rowHeights:23,colWidths:[100,100,100,100,100,150,100,100,80,80,100,100,130,100,100,100,100,100,100,100,100]})}}},C=o(62),component=Object(C.a)(k,(function(){var e=this,t=e._self._c;return t(m.a,[t(c.a,{attrs:{sm12:""}},[t(r.a,[t("form",[t(d.d,[t("span",{staticClass:"text-subtitle-2"},[e._v(e._s(e.formTitle))])]),e._v(" "),t(d.c,[t(m.a,{attrs:{wrap:""}},[t(c.a,{staticClass:"pa-2",attrs:{xs12:"",md2:""}},[t(h.a,{attrs:{outlined:"",dense:"","hide-details":"auto","return-object":"",loading:e.loading,items:e.itemType,label:"Item Type"},model:{value:e.form.itemType,callback:function(t){e.$set(e.form,"itemType",t)},expression:"form.itemType"}})],1),e._v(" "),t(c.a,{staticClass:"pa-2",attrs:{xs12:"",md2:""}},[t(h.a,{attrs:{outlined:"",dense:"","hide-details":"auto","return-object":"",loading:e.loading,items:e.requestType,label:"Request Type"},model:{value:e.form.requestType,callback:function(t){e.$set(e.form,"requestType",t)},expression:"form.requestType"}})],1),e._v(" "),t(c.a,{staticClass:"pa-2",attrs:{xs12:"",md2:""}},[t(f.a,{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(o){var n=o.on,r=o.attrs;return[t(v.a,e._g(e._b({attrs:{outlined:"",dense:"","hide-details":"auto",label:"Date From","prepend-icon":"mdi-calendar",readonly:""},model:{value:e.form.dateFrom,callback:function(t){e.$set(e.form,"dateFrom",t)},expression:"form.dateFrom"}},"v-text-field",r,!1),n))]}}]),model:{value:e.menu1,callback:function(t){e.menu1=t},expression:"menu1"}},[e._v(" "),t(l.a,{attrs:{"no-title":""},on:{input:function(t){e.menu1=!1}},model:{value:e.form.dateFrom,callback:function(t){e.$set(e.form,"dateFrom",t)},expression:"form.dateFrom"}})],1)],1),e._v(" "),t(c.a,{staticClass:"pa-2",attrs:{xs12:"",md2:""}},[t(f.a,{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(o){var n=o.on,r=o.attrs;return[t(v.a,e._g(e._b({attrs:{outlined:"",dense:"","hide-details":"auto",label:"Date To","prepend-icon":"mdi-calendar",readonly:""},model:{value:e.form.dateTo,callback:function(t){e.$set(e.form,"dateTo",t)},expression:"form.dateTo"}},"v-text-field",r,!1),n))]}}]),model:{value:e.menu2,callback:function(t){e.menu2=t},expression:"menu2"}},[e._v(" "),t(l.a,{attrs:{"no-title":""},on:{input:function(t){e.menu2=!1}},model:{value:e.form.dateTo,callback:function(t){e.$set(e.form,"dateTo",t)},expression:"form.dateTo"}})],1)],1),e._v(" "),t(c.a,{staticClass:"pa-2",attrs:{xs12:"",md2:""}},[t(n.a,{attrs:{small:"",loading:e.loading,color:"green darken-1",dark:""},on:{click:function(t){return e.preview()}}},[e._v("Preview\n              ")])],1),e._v(" "),t(c.a,{staticClass:"pa-2",attrs:{xs12:"",md2:""}},[t(n.a,{attrs:{small:"",loading:e.loading1,size:"mini",color:"blue darken-1",dark:""},on:{click:function(t){return e.exportPrev()}}},[e._v("\n                Export\n              ")])],1),e._v(" "),t(c.a,{staticClass:"pa-2",attrs:{xs12:""}},[t("div",{staticClass:"scroll-container-height"},[t("hot-table",{ref:"preview",attrs:{root:e.detailsRoot,settings:e.settings}})],1)])],1)],1)],1)])],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);