(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{739:function(t,e,r){"use strict";r.r(e);var n=r(111),o=r(840),l=r(1070),c=r(278),h=r(277),d=r(635),m=(r(34),r(240),r(33),r(85),r(6),r(36),r(12),r(13),{name:"FormTask",props:{title:{type:String,default:""}},data:function(){return{loading:!1,allData:[],documentStatus:[],itemSearch:[],searchStatus:"Y"===this.$auth.user.is_sap_user?"pending":"draft",searchItem:"",search:"",totalData:0,options:{},form:{},listType:"myTicket",headers:[{text:"Task Number",value:"task_number",cellClass:"disable-wrap"},{text:"Title",value:"title",cellClass:"disable-wrap"},{text:"Sub Category",value:"sub_category.category_name",cellClass:"disable-wrap"},{text:"Milestone",value:"section.title",cellClass:"disable-wrap"},{text:"Doc Date",value:"created_at",cellClass:"disable-wrap"},{text:"Due Date",value:"due_date",cellClass:"disable-wrap"},{text:"Assiged To",value:"assignees",cellClass:"disable-wrap"},{text:"Priority",value:"priority.title",cellClass:"disable-wrap"},{text:"Approval",value:"approve",cellClass:"disable-wrap"},{text:"Action",value:"id",align:"center",cellClass:"disable-wrap",sortable:!1,filterable:!1}]}},computed:{batchItems:function(){return"Y"===this.$auth.user.is_sap_user?["Approve","Reject"]:"draft"===this.searchStatus?["Submit Approval","Delete"]:"pending"===this.searchStatus?["Cancel"]:"approved"===this.searchStatus?["Download"]:("canceled"===this.searchStatus||this.searchStatus,[""])}},mounted:function(){this.getDataFromApi()},methods:{changeList:function(t){this.listType=t,this.getDataFromApi()},getInitial:function(t){var e=t.trim().split(" ");return e.reduce((function(t,r,n){return 0!==n&&n!==e.length-1||(t="".concat(t).concat(r.charAt(0).toUpperCase())),t}),"")},newData:function(){this.$emit("newData")},editItem:function(t){this.form=Object.assign({},t),this.statusProcessing="update",this.$emit("editItem",t)},itemRowBackground:function(t){return"Pending"===t.approval?"bg-orange":"bg-white"},batchActions:function(t){if(this.selected.length<1)this.$swal({type:"error",title:"Error",text:"Please select at least 1 row!"});else try{var e=this,r=[];switch(t){case"Submit Approval":e.batchSubmitDocument(this.selected);break;case"Delete":this.selected.forEach((function(t){r.push(t.id)})),e.batchDeleteDocument(r);break;case"Cancel":e.batchCancelDocument(this.selected);break;case"Reject":this.$refs.formApproval.editItem(this.selected,"Reject");break;case"Approve":this.$refs.formApproval.editItem(this.selected,"Approve")}}catch(t){this.$swal({type:"error",title:"Error",text:t})}},emitData:function(data){this.documentStatus=data.documentStatus,this.itemSearch=data.itemSearch,this.searchStatus=data.searchStatus,this.searchItem=data.searchItem,this.search=data.search,this.filters=data.filters,this.getDataFromApi()},getDataFromApi:function(){var t=this;this.loading=!0,this.$axios.get("/api/tasks/task",{params:{options:this.options,searchItem:this.searchItem,documentStatus:this.documentStatus,searchStatus:this.searchStatus,search:this.search,listType:this.listType}}).then((function(e){t.loading=!1,t.allData=e.data.data.rows,t.totalData=e.data.data.total,t.$emit("dataForToolbar",{itemSearch:e.data.filter}),t.form=Object.assign({},e.data.data.form),t.defaultItem=Object.assign({},e.data.data.form)})).catch((function(e){t.loading=!1,t.$swal({type:"error",title:"Error",text:e.response.data.message})}))}}}),f=r(61),component=Object(f.a)(m,(function(){var t=this,e=t._self._c;return e("div",[e(c.a,{attrs:{value:t.loading}},[e(h.a,{attrs:{indeterminate:"",size:"64"}})],1),t._v(" "),e(l.a,{staticClass:"elevation-0",attrs:{"mobile-breakpoint":0,headers:t.headers,items:t.allData,"items-per-page":20,options:t.options,"server-items-length":t.totalData,"fixed-tabs":"","show-select":"",dense:"","fixed-header":"",height:"70vh","footer-props":{"items-per-page-options":[20,50,100,-1]}},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"top",fn:function(){return[e("LazyMainToolbar",{attrs:{"document-status":t.documentStatus,"search-status":t.searchStatus,"item-search":t.itemSearch,"search-item":t.searchItem,search:t.search,title:"Ticket Lists","new-data-text":"New Ticket","show-batch-action":!0,"batch-actions":t.batchItems},on:{emitData:t.emitData,newData:t.newData,batchActions:t.batchActions,getDataFromApi:t.getDataFromApi}})]},proxy:!0},{key:"item.id",fn:function(r){var o=r.item;return[e(n.a,{staticClass:"font-weight-bold text-right",attrs:{small:"",text:"",color:"primary"},on:{click:function(e){return t.editItem(o)}}},[t._v("\n        Edit\n      ")])]}},{key:"item.assignees",fn:function(r){var o=r.item;return t._l(JSON.parse(o.assignees),(function(r){return e(d.a,{key:r.nik,attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(o){var l=o.on,c=o.attrs;return[e(n.a,t._g(t._b({staticClass:"white--text",attrs:{"x-small":"",color:"green",depressed:"",fab:""}},"v-btn",c,!1),l),[t._v("\n            "+t._s(t.getInitial(r.name))+"\n          ")])]}}],null,!0)},[t._v(" "),e("span",[t._v(t._s(r.name))])])}))}},{key:"item.approve",fn:function(r){var n=r.item;return[e(o.a,{attrs:{color:"0"===n.approve?"orange":"green",label:"",small:"","text-color":"white"}},["0"===n.approve?e("span",{attrs:{left:""}},[t._v("Pending ")]):e("span",{attrs:{left:""}},[t._v("Approve ")])])]}}],null,!0)})],1)}),[],!1,null,null,null);e.default=component.exports}}]);